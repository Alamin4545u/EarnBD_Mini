<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Monetag Auto-Loop Pro</title>
    
    <!-- Monetag SDK -->
    <script src='//libtl.com/sdk.js' data-zone='10197154' data-sdk='show_10197154'></script>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #ffd700; --bg: #0d1117; --blue: #58a6ff; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        .container { width: 85%; max-width: 380px; background: #161b22; border-radius: 25px; padding: 35px; text-align: center; border: 1px solid #30363d; box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .status-bar { display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 20px; font-size: 12px; color: #8b949e; }
        .dot { width: 8px; height: 8px; background: #238636; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 0.2; } 50% { opacity: 1; } 100% { opacity: 0.2; } }
        #timer { font-size: 72px; font-weight: 800; color: var(--gold); margin: 15px 0; }
        .count-box { background: #0d1117; padding: 15px; border-radius: 15px; border: 1px solid #30363d; margin-top: 20px; }
        #msg { color: var(--blue); font-size: 14px; min-height: 20px; }
        .btn-main { background: #238636; color: white; border: none; padding: 15px 35px; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <div class="status-bar"><span class="dot"></span> AUTO-LOOP SYSTEM ACTIVE</div>
        
        <div id="setup-screen">
            <h2 style="color: var(--gold);">High CPM Bot</h2>
            <p style="font-size: 14px; color: #8b949e;">Ads will loop every 18 seconds.</p>
            <button class="btn-main" onclick="initLoop()">START ENGINE</button>
        </div>

        <div id="loop-screen" style="display: none;">
            <div id="timer">18</div>
            <div id="msg">Initializing Ads...</div>
            <div class="count-box">
                <div style="font-size: 11px; color: #8b949e;">TOTAL IMPRESSIONS</div>
                <div id="imp-count" style="font-size: 28px; font-weight: bold; color: #238636;">0</div>
            </div>
        </div>
    </div>

    <script>
        const tele = window.Telegram.WebApp;
        tele.expand();

        let count = localStorage.getItem('loop_count') || 0;
        document.getElementById('imp-count').innerText = count;

        function initLoop() {
            localStorage.setItem('is_running', 'true');
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('loop-screen').style.display = 'block';
            startTimer();
        }

        function startTimer() {
            let timeLeft = 18;
            const timerEl = document.getElementById('timer');
            const msgEl = document.getElementById('msg');

            const loop = setInterval(() => {
                timeLeft--;
                timerEl.innerText = timeLeft;

                if (timeLeft === 5) {
                    msgEl.innerText = "üöÄ Requesting High CPM Ad...";
                    // In-App Interstitial ‡¶ï‡¶≤ (‡¶è‡¶ü‡¶ø ‡¶∏‡ßá‡¶∂‡¶® ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶Æ‡ßã‡¶°‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
                    show_10197154({
                        type: 'inApp',
                        inAppSettings: {
                            frequency: 1, 
                            capping: 0.0001, 
                            interval: 0, 
                            timeout: 0, 
                            everyPage: true // ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡¶ø‡¶¨‡ßá
                        }
                    });
                }

                if (timeLeft <= 0) {
                    clearInterval(loop);
                    msgEl.innerText = "üí∞ Showing Rewarded Ad...";
                    
                    // Rewarded Interstitial ‡¶ï‡¶≤
                    if (typeof show_10197154 === 'function') {
                        show_10197154().then(() => {
                            completeStep();
                        }).catch(() => {
                            completeStep(); // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶®‡¶æ ‡¶Ü‡¶∏‡¶≤‡ßá‡¶ì ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶π‡¶¨‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶≤‡ßÅ‡¶™ ‡¶®‡¶æ ‡¶•‡¶æ‡¶Æ‡ßá
                        });
                    } else {
                        completeStep();
                    }

                    // ‡¶∏‡ßá‡¶´‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßã‡¶°: ‡¶Ø‡¶¶‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ì‡¶™‡ßá‡¶® ‡¶π‡ßü‡ßá ‡¶Ü‡¶ü‡¶ï‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶¨‡ßá ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶Ö‡¶ü‡ßã ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶π‡¶¨‡ßá
                    setTimeout(completeStep, 5000);
                }
            }, 1000);
        }

        function completeStep() {
            // ‡¶á‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
            let currentCount = parseInt(localStorage.getItem('loop_count') || 0);
            localStorage.setItem('loop_count', currentCount + 1);
            
            // ‡¶≠‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∂‡¶®
            if (tele.HapticFeedback) tele.HapticFeedback.notificationOccurred('success');
            
            // ‡¶π‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ (‡¶è‡¶ü‡¶ø‡¶á ‡¶≤‡ßÅ‡¶™ ‡¶¨‡¶ú‡¶æ‡ßü ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá)
            location.reload();
        }

        // ‡¶Ö‡¶ü‡ßã-‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü ‡¶ö‡ßá‡¶ï (‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá)
        window.onload = () => {
            if (localStorage.getItem('is_running') === 'true') {
                initLoop();
            }
        };
    </script>
</body>
</html>
